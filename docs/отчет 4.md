**Отчет 4: Реализация логики отрыва и улучшение визуализации**

**Проект:** "Математические модели для решения физических задач: Мотоциклист в сфере"
**Команда:** Кривошеин, Сулимов, Юдинцев
**Отчетный период:** Неделя 4 ( 7 апреля - 13 апреля )

---

#### **1. Краткое напоминание цели проекта**

Целью нашего проекта остается создание математической модели и интерактивного графического интерфейса для анализа движения мотоциклиста внутри "шара смерти". Мы стремимся понять условия устойчивого движения, определить минимально необходимую скорость для трюка с отделением нижней части сферы, и предоставить пользователю возможность исследовать влияние различных параметров на траекторию и динамику движения.

---

#### **2. Проделанная работа за неделю**

В течение прошедшей недели команда сосредоточилась на улучшении динамической модели и визуализации, а также начала подготовку к сравнению с теоретическими результатами:

### Юдинцев Степан занимался:

1. **Реализация логики отрыва (`model.py`):** Добавлена проверка условия отрыва точки от поверхности сферы. Логика основана на сравнении центробежной силы ($F_c = mv^2/R$) с компонентой силы тяжести, перпендикулярной к поверхности в данной точке ($F_{g,n} = mg|\cos\theta|$, где $\theta$ - угол с вертикалью). Отрыв происходит, если $F_c$ превышает $F_{g,n}$ (с небольшим запасом). Это ключевой шаг к моделированию условий, при которых мотоциклист может удерживаться на стенке без опоры снизу.
2. **Жесткая коррекция положения и скорости (`model.py`):** Внедрен механизм, который принудительно возвращает точку на поверхность сферы и делает ее скорость строго касательной на каждом шаге интегрирования, *пока активен флаг контакта*. Это сделано для борьбы с численным дрейфом и удержания точки на сфере во время движения по поверхности. *Примечание: Взаимодействие этой коррекции с ранее существовавшей логикой обработки столкновений (с коэффициентом восстановления) требует дальнейшего анализа и возможной переработки.*
3. **Уточнение направления силы тяги (`model.py`):** Направление силы тяги теперь более строго определяется как касательное к параллели сферы (горизонтальное направление), что лучше соответствует интуитивному представлению о движении мотоциклиста, стремящегося двигаться по горизонтальной окружности.

### Андрей Сулимов занимался:

4. **Улучшение визуализации (`animation.py`):**
   * Добавлено отображение вектора силы тяги (оранжевый цвет), исходящего из текущего положения точки, когда сила тяги активна.
   * Добавлено отображение вектора силы тяжести (зеленый цвет), также исходящего из текущего положения точки. Это помогает визуально оценить действующие силы.
5. **Интерфейс (`main.py`):** Пока не были внесены изменения в цветовую схему (остается темной).

### Кривошеин Алексей занимался:

6. **Отображение критической скорости (`main.py`):** В информационную панель добавлен расчет и отображение "критической скорости" $v_{crit} = \sqrt{gR}$. Это значение часто используется в анализе движения по вертикальной петле (скорость в верхней точке) или по экватору без трения, и служит важной точкой отсчета для сравнения с результатами симуляции и литературными данными.
7. **Интеграция и тестирование:** Проведена интеграция обновленных модулей модели и визуализации, выполнено начальное тестирование новых функций (отрыв, векторы сил).
8. **Написание отчета.**

---

#### **3. Описание реализованной динамической модели**

Текущая математическая модель по-прежнему описывает движение материальной точки массы $m$ внутри сферы радиуса $R$. Основные изменения затронули обработку сил и ограничений:

* **Сила тяжести:** $\vec{F}_g = (0, -mg, 0)$.
* **Сила тяги:** $\vec{F}_{drive}$. Модуль задается пользователем, направление – тангенциально к горизонтальной параллели сферы. Применяется только при контакте.
* **Обработка контакта и отрыва:**
  * **Во время контакта:** Положение точки принудительно удерживается на радиусе $R$, а ее скорость корректируется, чтобы быть строго касательной к сфере. Это помогает стабилизировать движение по поверхности.
  * **Условие отрыва:** На каждом шаге во время контакта проверяется условие $m v^2 / R \ge mg |\cos\theta| \times 1.05$. Если оно выполняется, флаг `contact` устанавливается в `False`, и сила тяги перестает действовать.
  * **После отрыва:** Точка движется как свободно брошенное тело под действием только силы тяжести ($\vec{F}_{net} = \vec{F}_g$).
  * **Восстановление контакта:** Если точка в свободном полете снова достигает поверхности сферы (проверяется условие $r \ge R - \epsilon$), флаг `contact` устанавливается в `True`. При этом используется логика обработки столкновения с коэффициентом восстановления для коррекции скорости (как было реализовано ранее). *Потенциально, взаимодействие между жесткой коррекцией во время контакта и обработкой столкновения при восстановлении контакта требует уточнения.*
* **Сила трения и явная нормальная сила:** По-прежнему не включены в модель.

**Численный метод:** Используется **Semi-implicit Euler** с шагом $dt$.

---

#### **4. Статус реализации GUI**

Графический интерфейс теперь включает:

* Отображение расчетной "критической скорости" ($\sqrt{gR}$) на панели информации.
* Визуализацию в 3D-окне не только траектории и положения точки, но и векторов силы тяжести и силы тяги (когда она активна).
* Остальные функции (ввод параметров, таймлайн, управление камерой) сохранены.
* Цветовая схема интерфейса остается темной.

---

#### **5. Обоснование изменений**

Реализация **логики отрыва** является критически важным шагом, так как именно способность мотоциклиста удерживаться на стенках без поддержки снизу (т.е. при $N \ge mg|\cos\theta| / \sin^2\alpha$ или в нашем упрощении $mv^2/R \ge mg|\cos\theta|$) составляет суть трюка. Хотя текущая реализация упрощена (не учитывает трение), она позволяет моделировать сам *факт* отрыва и переход в режим свободного полета.

**Жесткая коррекция** во время контакта была добавлена для повышения стабильности движения по поверхности, хотя ее физическая обоснованность и взаимодействие с другими частями модели требуют дальнейшего изучения.

**Визуализация сил** и **отображение $v_{crit}$** улучшают понимание происходящих процессов и облегчают сравнение результатов симуляции с теорией.

---

#### **6. Планы на следующую неделю**

1. **Отладка и верификация логики отрыва/контакта:** Тщательно протестировать и отладить поведение модели в моменты отрыва и повторного контакта. Проанализировать взаимодействие "жесткой коррекции" во время контакта и логики столкновения при восстановлении контакта. Убедиться в физической правдоподобности траекторий свободного полета внутри сферы.
2. **Сравнение с литературными данными:** Провести более систематическое сравнение. Запустить симуляции с параметрами, близкими к описанным в статьях (McDonald K.T., «Квант»), и сравнить условия (например, минимальную скорость для движения на определенной высоте *без отрыва* в нашей текущей модели) с теоретическими предсказаниями или результатами этих работ (насколько это возможно без учета трения).
3. **Переработка интерфейса (Светлая тема):** Реализовать переход на светлую цветовую схему для GUI, как планировалось ранее.
4. **Рассмотрение добавления трения:** Если модель контакта/отрыва будет стабилизирована, пересмотреть возможность добавления в модель силы трения (зависящей от нормальной силы, которую потребуется оценивать), так как она является ключевым фактором для удержания на траекториях выше экватора согласно литературе.
5. **Рефакторинг и документирование кода:** Улучшить читаемость кода `model.py`, добавить комментарии, поясняющие сложную логику обработки контактов и отрыва.

---
